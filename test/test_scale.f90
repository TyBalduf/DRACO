module test_scale
    use testdrive, only : new_unittest, error_type, unittest_type, check_=>check, test_failed
    use draco, only: TDraco
    use mctc_env, only: wp, err_type => error_type
    implicit none
    integer, parameter :: scalable_atoms(8) = (/1, 6, 7, 8, 9, 16, 17, 35/)
    character(len=*), parameter :: solvent(2) = (/'water       ', 'acetonitrile'/)

contains

subroutine collect_scaletests(testsuite)
    !> Collection of tests
    type(unittest_type), allocatable, intent(out) :: testsuite(:)

    testsuite = [ &
        new_unittest("scale_cpcm", test_scale_cpcm), &
        new_unittest("scale_cosmo", test_scale_cosmo), &
        new_unittest("scale_smd", test_scale_smd) &
        ]

end subroutine collect_scaletests

!> Test for the scaling of the CPCM model
subroutine test_scale_cpcm(error)
    !> Error handline
    type(error_type), intent(out), allocatable :: error
    type(TDraco) :: drac
    real (wp), parameter, dimension(113,2) :: refradii_cpcm = reshape([ &
    1.3554183386034024, 1.4133793096183169, 1.4062092195463771, 1.5302903774854144, &
    1.5032737686679600, 1.3500630969312779, 1.1967871463299784, 1.3503893142064114, &
    1.1715617841309023, 1.1881947718204400, 1.1747982717346046, 1.1669023691364984, &
    1.5318027101461598, 1.1602404254457896, 1.9015053633838885, 1.5574600208953167, &
    1.9395643116081049, 1.7016863028442373, 1.8233670482737683, 1.7937438768166292, &
    1.9469754096667120, 1.8243624439503434, 1.4658172453083540, 1.6939310678641291, &
    1.7041472234789590, 1.9609766419135188, 1.5233672802501190, 1.6375284219908066, &
    1.3243921415805691, 1.8895418285123942, 1.7635939683433182, 1.6245321101857837, &
    1.2854802719915759, 1.3409413930193026, 1.3587882376582465, 2.0761281988684055, &
    2.1392686659902318, 1.3966220832959806, 2.1059419132174515, 2.1207067680115954, &
    1.7381868440904769, 1.8412136990094763, 1.3954402792690497, 1.5747001158115468, &
    1.5844450191308068, 1.8192244415282313, 1.5556456840441684, 1.5564694065581446, &
    1.5605983077897136, 1.7029671016046370, 1.5904532706126708, 1.5647550698754036, &
    2.1269655695280059, 1.5647464198444929, 1.5590763265423153, 1.7255840212182956, &
    1.5631334409194837, 1.5647203812335888, 1.5740618082041069, 1.5594578052703272, &
    1.5534914111267353, 1.5598163420042801, 1.5392793770636939, 1.5026282190640377, &
    1.4984427692031650, 1.5452097483699203, 1.5215992011064490, 1.5544247590552611, &
    1.5017143145729048, 1.5591258693709895, 1.5570472248012517, 1.4835118865953876, &
    1.5933768067323362, 1.5517680968874643, 1.5932172218507883, 1.5029423616952915, &
    1.5609653537261665, 1.5981626631095380, 1.6026922785750100, 1.5457763836895719, &
    1.5617878733053676, 1.5981108098481576, 1.4837740686142304, 1.2123525841623817, &
    1.1136482838971009, 1.6122442302474573, 1.5766219800172256, 1.5029066868170542, &
    1.5651883870195278, 1.5141910779046790, 1.6130224589092359, 1.6144684780444298, &
    1.5714693486886504, 1.5843804974394864, 1.5868687530726686, 1.5424285092811303, &
    1.5138842847068859, 1.5139295320985673, 1.5689931018529533, 1.5682444709288834, &
    1.1712652772822221, 1.5710453389206804, 1.2331810262114782, 1.5474144335458921, &
    1.5903457813883628, 1.5706633756251125, 1.5754486589828203, 1.5738897964433278, &
    1.5454208579917965, 1.5377738099368357, 1.5642059204910583, 1.5720493251762659, &
    1.5715988202205369, &
    2.0026239404614321, 1.9627408980345309, 1.9698812264961501, 1.8762588626521159, &
    1.8887320876366975, 2.0097186651766319, 2.0817765255291789, 2.0083806369232469, &
    2.0981165980793715, 2.0836916856974796, 2.0955633245349996, 2.1047335993284610, &
    1.8685671162783273, 2.1109449701395517, 2.2037258535057584, 1.7661425290180994, &
    1.7869179163638167, 1.7728821355235986, 1.7824863688383901, 1.7732217153801173, &
    1.7819655224893025, 1.7753318413168058, 1.7916687683064851, 1.7725126316463422, &
    1.7729211971529193, 1.6642124721787650, 1.7748770833273844, 1.7921932518973418, &
    1.8019506594908228, 1.7767736811682167, 1.7729741568508885, 1.8059382730196054, &
    1.8083229929216005, 1.7970928358795220, 1.8258444506132663, 1.5313830194060551, &
    1.5437647082494388, 1.8310913215304878, 1.5261004895847177, 1.5301448044958286, &
    1.7593158184426787, 1.7673902530168997, 1.8318062022527353, 1.8390185434458979, &
    1.8331495178332686, 1.7760957127744530, 1.8594702608731817, 1.8593994465204617, &
    1.8562876184184145, 1.7743205923525665, 1.8315979893279160, 1.8439074414935228, &
    1.5403334308565715, 1.8538179247495707, 1.8571369186995761, 1.7653231516129968, &
    1.8549598323522734, 1.8446103274300401, 1.8399131756460672, 1.8570616476091661, &
    1.8606608458123235, 1.8568642591967695, 1.1055850620446814, 1.0893858495309272, &
    1.0849024017719506, 1.1124243831805984, 1.1008426093083943, 1.1185754810835664, &
    1.0911045170975757, 1.1225832216352061, 1.1198867951397760, 1.0794636870779961, &
    1.1408761356600170, 1.1184245933423265, 1.1389961412184171, 1.0878352684761106, &
    1.1195585632426244, 1.1436794957918344, 1.1459276675559535, 1.1138453399617594, &
    1.1238567757886120, 1.1434752971677513, 1.0801190796807292, 0.9404690915094129, &
    0.8865038087791254, 1.1515010963877865, 1.1318699539202985, 1.0918411123535412, &
    1.1256469464093075, 1.0978728600300376, 1.1518122274435285, 1.1512499681692840, &
    1.1290976174347767, 1.1361646079275221, 1.1374272611176279, 1.1118445136598207, &
    1.0964994080877168, 1.0936844091445452, 1.1264716991757080, 1.1260695878289897, &
    0.9158075613397750, 1.1276169759759400, 0.9466561414267223, 1.1146464753196721, &
    1.1381397193610980, 1.1273704547922976, 1.1300009895657721, 1.1291634768429804, &
    1.1136977032233508, 1.1094695698774415, 1.1238650532151147, 1.1281413470461370, &
    1.1279100612570465 ], [113, 2])

    integer :: tmpunit, i

    call write_taxol("tmp.xyz")
    call drac%init("tmp.xyz",0,'eeq','cpcm',write_all=.false.,damp_small_rad=.true.)
    call delete_file("tmp.xyz")
    do i=1,2
        call drac%loadParam(solvent(i))
        call drac%calc(solvent(i),scalable_atoms)
        call check_(error,all(abs(drac%scaledradii - refradii_cpcm(:,i)) < 1e-2),"Error while scaling radii for CPCM")
    end do

end subroutine test_scale_cpcm


!> Test for the scaling of the COSMO model
subroutine test_scale_cosmo(error)
    !> Error handline
    type(error_type), intent(out), allocatable :: error
    type(TDraco) :: drac

    real(wp), parameter, dimension(113,2) :: refradii_cosmo = reshape([ &
    1.2972467243315946, 1.3443160321953314, 1.3384267425106047, 1.4393139553492229, 1.4176206736225572, &
    1.2927887170160202, 1.1688064039040598, 1.2930882780027426, 1.1481718114517576, 1.1618867963317423, &
    1.1508341466927785, 1.1442540693218757, 1.4407650726457908, 1.1387440790753389, 1.8858855341940990, &
    1.6126589099421151, 1.7814380818727948, 1.6768541222278228, 1.7304596302379400, 1.7174512989964341, &
    1.7846958454292456, 1.7309085909043755, 1.5712566223220017, 1.6734235625911165, 1.6779424330471859, &
    1.7910288344885483, 1.5973185134248336, 1.6483722609639613, 1.5061876324246222, 1.7595175932508811, &
    1.7041790842363436, 1.6425671823182735, 1.4879553859145997, 1.5138987751997883, 1.5221319160925939, &
    1.8418016203117575, 1.8695875844922125, 1.5395772080706169, 1.8549295079102075, 1.8614266286311314, &
    1.6929997962580592, 1.7383233347077640, 1.5390327760450857, 1.6202682336636598, 1.6246374667097214, &
    1.7286496672658123, 1.6116963489096432, 1.6120660246729934, 1.6139228346518539, 1.6774182762414338, &
    1.6273256459897303, 1.6158059294185076, 1.8641678932737666, 1.6157863116586861, 1.6132389643365381, &
    1.6874273781100586, 1.6150615269755526, 1.6157892658898132, 1.6199810596782380, 1.6134101672737822, &
    1.6107277681565808, 1.6135712678584202, 1.4067278710401270, 1.3838086577766178, 1.3811654022954420, &
    1.4104985055716024, 1.3956962565111946, 1.4163088192822000, 1.3832646833781292, 1.4192866044923682, &
    1.4179583950292196, 1.3718763802217555, 1.4409139210811610, 1.4146527894587910, 1.4407910656020655, &
    1.3839838069223573, 1.4203962088691593, 1.4439486015313707, 1.4468182028593299, 1.4108683400685043, &
    1.4209615186617113, 1.4439135984711098, 1.3720462920858738, 1.2040788746628559, 1.1428183609242089, &
    1.4528872151091128, 1.4303187885625512, 1.3840111740040533, 1.4231040758300422, 1.3910694404461434, &
    1.4533804067756702, 1.4542831859726086, 1.4270662180145677, 1.4352228549742907, 1.4367955759598077, &
    1.4087619926277526, 1.3908625241904653, 1.3908558680635226, 1.4254882573147627, 1.4250160968789711, &
    1.1786006557763855, 1.4267834065297407, 1.2168944772919175, 1.4118971181828126, 1.4389815658014669, &
    1.4265419144141731, 1.4295628188598202, 1.4285787094752103, 1.4106454050848287, 1.4058400587009985, &
    1.4224694983729449, 1.4274167269685902, 1.4271325823145324, &
    2.0059231857698876, 1.9763983905636677, 1.9816887787357556, 1.9117739707749091, 1.9211761898846040, &
    2.0111459385642392, 2.0641811888471482, 2.0101630436824869, 2.0761229966809363, 2.0655969212467191, &
    2.0742602451295364, 2.0809380665525663, 1.9060006368398161, 2.0854610659684525, 2.1887756614186249, &
    1.8495148984161967, 1.7511690370723467, 1.8110287916223842, 1.7816969042377824, 1.7845141402881199, &
    1.7460132854568724, 1.7769963969947686, 1.8931415790079003, 1.8130674860279781, 1.8103340212551180, &
    1.6694658210840625, 1.8652019694768238, 1.8418349246113821, 1.9437224440553929, 1.7592000888685411, &
    1.7930775113674260, 1.8541883974524238, 1.9601747005802490, 1.9354380974338017, 1.9476319062401233, &
    1.5549794185871804, 1.5451909992177137, 1.9390005169607072, 1.5434560913646069, 1.5418862768243018, &
    1.7919991958097041, 1.7672550411308066, 1.9398126981913377, 1.8894938194057138, 1.8829498367937174, &
    1.7789459042787361, 1.9078508647681318, 1.9075593481990156, 1.9043958341254650, 1.8115448427901608, &
    1.8801958497354325, 1.8954976111723287, 1.5464699679889251, 1.9016242012580216, 1.9053779073727690, &
    1.7993813250250361, 1.9028139917112492, 1.8959424551964799, 1.8902380269368322, 1.9052167428329636, &
    1.9092344723840722, 1.9049870471941428, 1.0443819163210513, 1.0311517380670436, 1.0276609262403593, &
    1.0496960412318241, 1.0403086268430974, 1.0545877488976874, 1.0324182581561510, 1.0577377067000562, &
    1.0556497198421773, 1.0231473681845988, 1.0724928764464616, 1.0543975480285035, 1.0710741215280271, &
    1.0299945282963177, 1.0555162033585903, 1.0747417668285484, 1.0765658171707873, 1.0507809785750217, &
    1.0587725643655703, 1.0745866484076441, 1.0236477002797011, 0.91098442544038072, 0.86750383635171746, &
    1.0810395086650151, 1.0652298593442329, 1.0330061153672756, 1.0602174396765067, 1.0378636683971105, &
    1.0812965111651984, 1.0809161813237125, 1.0629949375024841, 1.0686860974337511, 1.0697084449718586, &
    1.0491798878767762, 1.0368220478842509, 1.0347063313554214, 1.0609481029368530, 1.0606239529681729, &
    0.89123852166793205, 1.0618690445739987, 0.91621963183731081, 1.0514306665147830, 1.0703459450609798, &
    1.0616725438397197, 1.0637900585827655, 1.0631148260765957, 1.0506597082935540, 1.0472599960079352, &
    1.0588488496688511, 1.0622925888197750, 1.0621055506343446 ],[113,2])
    integer :: tmpunit, i

    call write_taxol("tmp.xyz")
    call drac%init("tmp.xyz",0,'eeq','cosmo',write_all=.false.,damp_small_rad=.true.)
    call delete_file("tmp.xyz")
    do i=1,2
        call drac%loadParam(solvent(i))
        call drac%calc(solvent(i),scalable_atoms)
        call check_(error,all(abs(drac%scaledradii - refradii_cosmo(:,i)) < 1e-2),"Error while scaling radii for COSMO")
    end do

end subroutine test_scale_cosmo

!> Test for the scaling of the SMD model
subroutine test_scale_smd(error)
    !> Error handline
    type(error_type), intent(out), allocatable :: error
    type(TDraco) :: drac

    real (wp), parameter, dimension(113,2) :: refradii_smd = reshape([ &
    1.3139976447803610, 1.3141819113423994, 1.3150233772784024, 1.3107975941051828, &
    1.3087968865730670, 1.3152343787691614, 1.3002664891717193, 1.3148202527473736, &
    1.2991692792579264, 1.2985787286933625, 1.2991501921051807, 1.3002543564221629, &
    1.3081221261650069, 1.3006244810323944, 1.7755772292066305, 1.7132790592655360, &
    1.7312105701090794, 1.7201420771406626, 1.7258292706417389, 1.7244547566375734, &
    1.7315555123111677, 1.7258793440066773, 1.7088073479152130, 1.7197768121050556, &
    1.7202579491495595, 1.7322646917305589, 1.7116258963001481, 1.7170966304058140, &
    1.7017250470066374, 1.7289026363802769, 1.7230470920557415, 1.7164710154706131, &
    1.6997234091899343, 1.7025701838516984, 1.7034590658205910, 1.7376488724617332, &
    1.7405573329009061, 1.7053576503601375, 1.7390276654176362, 1.7397072202106365, &
    1.7218645803009183, 1.7266666800265684, 1.7052981813318657, 1.7140701681888248, &
    1.7145409736455439, 1.7256399544956227, 1.7131424575865126, 1.7131822035039448, &
    1.7133827822562273, 1.7202016380994261, 1.7148297579722434, 1.7135894133582641, &
    1.7399907298436186, 1.7135837937538576, 1.7133090199553118, 1.7212699889628720, &
    1.7135055543175848, 1.7135873747215025, 1.7140390327724728, 1.7133274379709675, &
    1.7130379534815188, 1.7133448135754668, 1.2297229225748039, 1.2205323381504274, &
    1.2201658115861667, 1.2301417757843995, 1.2244896156205296, 1.2319443785987991, &
    1.2197594835168368, 1.2326454523193433, 1.2325709632703454, 1.2161563000078719, &
    1.2406005340746478, 1.2310097077366338, 1.2410193324945780, 1.2210445528159806, &
    1.2340917518242760, 1.2416587611623484, 1.2427654740363754, 1.2299860017623674, &
    1.2332974085608408, 1.2416914315245058, 1.2160825064673562, 1.1553929673871133, &
    1.1343630862434784, 1.2448953149377491, 1.2367092429179598, 1.2200031065789307, &
    1.2340895599775743, 1.2225551886414994, 1.2451055492407044, 1.2457855601115162, &
    1.2355189047339445, 1.2384759896734294, 1.2390730746086493, 1.2292730818692144, &
    1.2227957122299202, 1.2235340643577339, 1.2352773427291905, 1.2351046453023411, &
    1.1472513193786287, 1.2357400963789733, 1.1612077747372505, 1.2303806137875573, &
    1.2401758926296222, 1.2356624360016726, 1.2367530620382090, 1.2363925847235298, &
    1.2298936813161201, 1.2281795485048206, 1.2341829464137366, 1.2359757820021524, &
    1.2358689930117059, &
    2.0555440293877854, 2.0020604293191506, 2.0113363025547017, 1.8866657791399815, &
    1.9042436818779764, 2.0645610524695175, 2.1657838101481990, 2.0629279717207218, &
    2.1877264265387715, 2.1689444157147735, 2.1843737649262964, 2.1960171356898615, &
    1.8771944816639363, 2.2040327790867948, 2.1246145521228614, 1.6178908964186320, &
    1.7082445017091319, 1.6511771260226213, 1.6828937312136456, 1.6681994702144507, &
    1.7045647394018186, 1.6758486834155601, 1.6263390669422708, 1.6493923082387296, &
    1.6516644326633230, 1.5877644208947332, 1.6203144968968886, 1.6588931118261885, &
    1.6093573115332547, 1.6890194364555320, 1.6625027979312004, 1.6703351574803429, &
    1.6080330530572085, 1.6077410216330532, 1.6400250819045090, 1.4727977605937748, &
    1.4964558558671837, 1.6526370140820681, 1.4725877863688488, 1.4792917944004769, &
    1.6441251548519340, 1.6708589045132369, 1.6531252011635076, 1.6943739857236104, &
    1.6902865084592840, 1.6756946917063731, 1.7113754083690553, 1.7114584894542340, &
    1.7091031375420989, 1.6528601663855365, 1.6898430393980097, 1.6974339258912838, &
    1.4907981259461309, 1.7073960137448028, 1.7096721296837363, 1.6478994400905933, &
    1.7082424669917213, 1.6981341201269027, 1.6951545810263047, 1.7096678523274165, &
    1.7121686061015022, 1.7095365151450777, 1.1834212397142851, 1.1641782620244407, &
    1.1588517373918705, 1.1915153910111900, 1.1777830956520488, 1.1987922104480835, &
    1.1662153926233270, 1.2035270876129600, 1.2003434194125242, 1.1523707419513491, &
    1.2251124357523764, 1.1986102380221946, 1.2229025379472609, 1.1623391159424425, &
    1.1999618989471541, 1.2284129546796916, 1.2310595357248129, 1.1931948312771143, &
    1.2050326871020536, 1.2281730442724976, 1.1531498109430358, 0.9852622716971400, &
    0.9197796686407138, 1.2376130683039999, 1.2144948405281604, 1.1670905964408615, &
    1.2071479270904153, 1.1742554665682092, 1.2379790616613959, 1.2373218884181025, &
    1.2112227860350495, 1.2195598665382934, 1.2210485242738338, 1.1908261784139282, &
    1.1726279398446888, 1.1692919741025372, 1.2081255014916699, 1.2076505291611861, &
    0.9553711863028589, 1.2094779836166829, 0.9927671956408666, 1.1941434415651284, &
    1.2218914149194289, 1.2091869741233998, 1.2122925744368054, 1.2113039251349138, &
    1.1930199236008501, 1.1880125298017259, 1.2050460036789392, 1.2100972223778423, &
    1.2098240892573129], [113, 2])


    integer :: tmpunit, i

    call write_taxol("tmp.xyz")
    call drac%init("tmp.xyz",0,'eeq','smd',write_all=.false.,damp_small_rad=.true.)
    call delete_file("tmp.xyz")
    call drac%calc('water',scalable_atoms)
    do i=1,2
        call drac%loadParam(solvent(i))
        call drac%calc(solvent(i),scalable_atoms)
        call check_(error,all(abs(drac%scaledradii - refradii_smd(:,i)) < 1e-2),"Error while scaling radii for SMD")
    end do

end subroutine test_scale_smd

subroutine write_taxol(filename)
    character(len=*), intent(in) :: filename
    integer :: tmpunit

    open(newunit=tmpunit, file=filename)
    write(tmpunit, '(a)') "113", &
        "Taxol molecule", &
        "O 6.11609999999999 -6.69780000000001 1.42370000000000", &
        "O 3.65860000000000 -5.00240000000000 -0.05990000000000", &
        "O 7.37640000000000 -3.24030000000000 -0.90400000000000", &
        "O 5.88239999999999 -1.94920000000000 -2.71620000000000", &
        "O 5.88589999999999 -3.57440000000000 4.44450000000000", &
        "O 1.97410000000000 -1.59040000000000 1.72210000000000", &
        "O 3.67560000000000 -2.44900000000000 3.45360000000000", &
        "O 5.46210000000000 1.66540000000000 -0.56410000000000", &
        "O 3.09380000000000 -7.18609999999999 -0.26390000000000", &
        "O 7.12459999999999 -4.59250000000000 -2.68190000000000", &
        "O 1.16420000000000 -3.65670000000000 2.02360000000000", &
        "O 5.87709999999999 3.72450000000000 -1.14210000000000", &
        "O 8.31399999999998 1.74610000000000 0.10760000000000", &
        "O 11.51850000000000 4.80910000000000 1.26110000000000", &
        "N 9.42489999999998 4.07090000000000 0.94520000000000", &
        "C 5.72719999999997 -3.88390000000000 0.70480000000000", &
        "C 4.92230000000000 -5.21020000000000 0.55220000000000", &
        "C 5.46459999999998 -3.14980000000000 2.03960000000000", &
        "C 4.89650000000000 -6.06130000000001 1.83660000000000", &
        "C 5.95340000000003 -3.19820000000000 -0.70240000000000", &
        "C 5.54270000000002 -1.80450000000000 -1.35200000000000", &
        "C 5.81530000000000 -4.17640000000000 3.18890000000000", &
        "C 4.86990000000000 -5.37099999999998 3.17660000000000", &
        "C 4.04110000000000 -1.46500000000000 -1.18820000000000", &
        "C 5.86950000000002 -6.32989999999998 0.06310000000000", &
        "C 4.08020000000000 -2.57780000000000 2.32090000000000", &
        "C 6.38780000000002 -0.58000000000000 -0.92410000000000", &
        "C 3.89670000000000 -1.17170000000000 0.28630000000000", &
        "C 6.53289999999999 -2.05850000000000 2.22270000000000", &
        "C 3.16580000000000 -2.14360000000000 1.16630000000000", &
        "C 5.77540000000001 0.42100000000000 0.08020000000000", &
        "C 4.58340000000000 -0.15030000000000 0.81520000000000", &
        "C 3.13070000000000 -2.56290000000000 -1.74280000000000", &
        "C 3.67220000000000 -0.22390000000000 -2.02630000000000", &
        "C 4.32120000000000 0.45690000000000 2.15780000000000", &
        "C 2.80140000000000 -6.02520000000000 -0.31550000000000", &
        "C 7.83510000000002 -3.93030000000000 -1.96120000000000", &
        "C 1.43970000000000 -5.50030000000000 -0.65880000000000", &
        "C 1.07760000000000 -2.46560000000000 2.18790000000000", &
        "C 6.20180000000000 2.76300000000000 -0.50010000000000", &
        "C 9.30040000000001 -3.81640000000000 -2.11740000000000", &
        "C 7.42920000000001 2.79420000000000 0.43220000000000", &
        "C -0.03420000000000 -1.76610000000000 2.91380000000000", &
        "C 10.06499999999999 -2.96470000000000 -1.3239000000000", &
        "C 9.91649999999999 -4.58530000000000 -3.10270000000000", &
        "C 8.12349999999999 4.16510000000000 0.30500000000000", &
        "C 11.43099999999999 -2.88790000000000 -1.5190000000000", &
        "C 11.28280000000002 -4.50510000000000 -3.2904000000000", &
        "C 12.04040000000001 -3.65590000000000 -2.4992000000000", &
        "C 7.31129999999999 5.29249999999999 0.89680000000000", &
        "C 6.98099999999999 6.38829999999998 0.11140000000000", &
        "C 6.93800000000000 5.28210000000000 2.23500000000000", &
        "C 10.57610000000003 4.66960000000000 0.51190000000000", &
        "C 6.27729999999999 7.44959999999998 0.65140000000000", &
        "C 6.23480000000001 6.34430000000002 2.77510000000000", &
        "C 10.60259999999999 5.07930000000000 -0.92270000000000", &
        "C 5.90259999999999 7.43010000000002 1.98400000000000", &
        "C 10.46960000000000 4.14790000000000 -1.94740000000000", &
        "C 10.80650000000000 6.41909999999998 -1.22980000000000", &
        "C 10.52900000000001 4.56070000000000 -3.26670000000000", &
        "C 10.85389999999999 6.82709999999997 -2.55070000000000", &
        "C 10.71409999999998 5.89939999999998 -3.56950000000000", &
        "H 6.74220000000001 -4.26400000000000 0.89040000000000", &
        "H 4.08430000000000 -6.79710000000001 1.78830000000000", &
        "H 5.53290000000001 -3.93420000000000 -1.40560000000000", &
        "H 6.82860000000000 -4.55040000000000 2.99890000000000", &
        "H 3.84560000000000 -5.05000000000000 3.38130000000000", &
        "H 5.17460000000000 -6.07450000000001 3.95270000000000", &
        "H 5.35399999999999 -7.13109999999998 -0.47060000000000", &
        "H 6.77349999999997 -6.04280000000000 -0.47250000000000", &
        "H 7.35320000000001 -0.92310000000000 -0.55580000000000", &
        "H 6.58389999999999 -0.03920000000000 -1.85120000000000", &
        "H 7.51199999999999 -2.53220000000000 2.25620000000000", &
        "H 6.38100000000000 -1.54810000000000 3.16940000000000", &
        "H 6.51749999999998 -1.35810000000000 1.40680000000000", &
        "H 2.90570000000000 -3.05190000000000 0.61380000000000", &
        "H 6.52860000000000 0.63750000000000 0.84230000000000", &
        "H 2.10120000000000 -2.36160000000000 -1.45390000000000", &
        "H 3.17600000000000 -2.54090000000000 -2.83040000000000", &
        "H 3.40910000000000 -3.55130000000000 -1.41160000000000", &
        "H 4.04820000000000 -0.35430000000000 -3.03830000000000", &
        "H 2.58920000000000 -0.13460000000000 -2.06620000000000", &
        "H 4.06590000000000 0.69950000000000 -1.63190000000000", &
        "H 5.48590000000001 -2.74900000000000 -3.08530000000000", &
        "H 5.00940000000000 -3.20650000000000 4.64220000000000", &
        "H 5.18350000000000 0.38930000000000 2.81900000000000", &
        "H 4.10240000000000 1.51570000000000 2.00730000000000", &
        "H 3.46420000000000 0.00130000000000 2.64030000000000", &
        "H 0.77910000000000 -6.33940000000001 -0.85360000000000", &
        "H 1.06970000000000 -4.92700000000000 0.19050000000000", &
        "H 1.48120000000000 -4.85200000000000 -1.52930000000000", &
        "H 7.06470000000002 2.66950000000000 1.46880000000000", &
        "H 0.23590000000000 -1.70960000000000 3.96720000000000", &
        "H -0.95370000000000 -2.33640000000000 2.82220000000000", &
        "H -0.15790000000000 -0.75840000000000 2.52970000000000", &
        "H 9.58450000000000 -2.36800000000000 -0.56480000000000", &
        "H 9.30490000000002 -5.23750000000000 -3.70730000000000", &
        "H 8.28149999999998 4.36280000000000 -0.75880000000000", &
        "H 12.02569999999998 -2.22690000000000 -0.9063000000000", &
        "H 11.75900000000003 -5.10260000000000 -4.0530000000000", &
        "H 9.21040000000002 2.05200000000000 0.31560000000000", &
        "H 13.10820000000000 -3.59090000000000 -2.6467000000000", &
        "H 9.40469999999998 3.92780000000000 1.94930000000000", &
        "H 7.26890000000002 6.40159999999999 -0.92850000000000", &
        "H 7.19680000000001 4.44580000000000 2.87050000000000", &
        "H 6.02300000000000 8.29509999999998 0.03030000000000", &
        "H 5.94919999999999 6.32400000000001 3.81640000000000", &
        "H 5.35510000000002 8.25919999999999 2.40640000000000", &
        "H 10.33249999999999 3.10100000000000 -1.71680000000000", &
        "H 10.92090000000002 7.13289999999998 -0.42780000000000", &
        "H 10.42800000000002 3.83430000000000 -4.05900000000000", &
        "H 11.00399999999998 7.87030000000002 -2.78510000000000", &
        "H 10.75430000000001 6.21879999999998 -4.60010000000000"
    close(tmpunit)

end subroutine write_taxol

subroutine delete_file(filename)
    character(len=*), intent(in) :: filename

    integer:: iunit

    open(newunit=iunit, file=filename, status='old')
    close(iunit, status='delete')

end subroutine delete_file

end module test_scale
